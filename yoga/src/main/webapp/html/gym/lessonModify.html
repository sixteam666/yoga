<!DOCTYPE HTML>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>课程添加删除</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by FreeHTML5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="FreeHTML5.co" />

	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="../../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../../css/icomoon.css">
	<!-- Themify Icons-->
	<link rel="stylesheet" href="../../css/themify-icons.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../../css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/magnific-popup.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/bootstrap-datepicker.min.css">

	<!-- Owl Carousel  -->
	<link rel="stylesheet" href="../../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../../css/owl.theme.default.min.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="../../css/style.css">

	<!-- Modernizr JS -->
	<script src="../../js/modernizr-2.6.2.min.js"></script>

	</head>
	<style type="text/css">
		.fon{
			font-family: "微软雅黑";
		}
		
		.table_lesson{
			width: 1000px!important;
			margin-left: -140px;
		}
		th{
			width: 80px!important;
			height: 50px!important;
		}
		.add_lesson{
			margin-top: 60px;
			margin-left: 220px;
		}
		.coach_select{
			width: 110px;
			height: 30px;
		}
		img{
			width: 50px;
		}
		
		.active{
			color: red;
			
		}
	</style>
	
	<style type="text/css">
    	.error_price,.error_number,.error_message{
    		color: red;
    		visibility: hidden;/*visible*/ 
    	}
    </style>
	<body>
		
	<div class="gtco-loader"></div>
	
	<div id="page">

	
	<nav class="gtco-nav" role="navigation">
		<div class="gtco-container">
			
			<div class="row" style="background-color:#09C6AB ;">
				<div class="col-sm-4 col-xs-12">
					<ul>
						<li><a href="gym.html" class="fon">首页</a></li>
						<li><a href="showCoach.html" class="fon">教练</a></li>
						<li><a href="showStudent.html" class="fon">学员</a></li>
					</ul>
				</div>
				<div class="col-xs-8 text-right menu-1">
					<ul>
						<li class="has-dropdown">
							<span style="color: white;">欢迎您，用户名</span>
							<a href="#">注销</a>
						</li>
						<li class="has-dropdown">
							<a href="#">场馆中心</a>
							<ul class="dropdown">
								<li><a href="/html/gym/index.html">场馆展示</a></li>
								<li><a href="/gym/showMessage.do">场馆资料</a></li>
								<li><a href="/html/gym/lesson.html">课程安排</a></li>
								<li><a href="/html/gym/wallet.html">我的钱包</a></li>
								<li><a href="/html/gym/myCoach.html">我的签约教练</a></li>
								<li><a href="/html/gym/MyMessage.html">我的通知</a></li>
							</ul>
						</li>
					</ul>	
			</div>
			</div>
			
		</div>
	</nav>
	
		<div class="gtco-section">
		<div class="gtco-container">
			<div class="row">
				<div class="col-md-8 col-md-offset-2 text-center gtco-heading">
					<h2>课程展示</h2>
				</div>
				<div class="col-md-8 col-md-offset-2 gtco-heading" style="font-size: 20px;">
							
					<table border="1" cellspacing="" cellpadding="" class="table_lesson">
						
						<tr align="center" style="font-weight: 700;">
							<td>课程教练</td>
							<td>课程价格</td>
							<td>可容纳学员人数</td>
							<td>已有学员人数</td>
							<td>课程描述</td>
							
						</tr>
						
						<tr align="center" class="gradeX" th:each="lesson,iterStat : ${list}">
							<input type="hidden" id="hid" th:value="${lesson.l_id}">
							<td th:if="${lesson.coachBean!=null}" th:text="${lesson.coachBean.c_nickname}">章教练</td>
							<td th:unless="${lesson.coachBean!=null}" th:text="暂无课程教练">章教练</td>
							<td>
								<span th:text="${lesson.l_price}">200</span>￥/节
							</td>
							<td th:text="${lesson.l_size}">10</td>
							<td th:text="${lesson.l_s_number}">0</td>
							<td th:text="${lesson.l_descirbe}">瘦身</td>
							
						</tr>
						
					</table>
					<div class="add_lesson">
						<button type="button" class="btn btn-info " data-toggle="modal" data-target="#myModal2">添加课程</button>
						<button type="button" class="btn btn-info " data-toggle="modal" data-target="#myModal">删除课程</button>
					</div>	
					
				</div>
			</div>
		</div>
	</div>
	
	<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">  
	    <div class="modal-dialog" role="document">  
	        <div class="modal-content">  
	            <div class="modal-header">  
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close">  
	                    <span aria-hidden="true">×</span>  
	                </button>  
	                <h4 class="modal-title" id="myModalLabel">删除课程</h4>  
	            </div>  
	            <div class="modal-body">  
	                <p>是否删除课程?</p>  
	            </div>  
	            <div class="modal-footer">  
	                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>  
	                <button type="button" class="btn btn-primary" onclick="delLesson()">确定</button>  
	            </div>  
	        </div>  
	    </div>  
	</div>  
	
	
	<div class="modal fade" id="myModal2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">  
	    <div class="modal-dialog" role="document">  
	        <div class="modal-content">  
	            <div class="modal-header">  
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close">  
	                    <span aria-hidden="true">×</span>  
	                </button>  
	                <h4 class="modal-title" id="myModalLabel">添加课程</h4>  
	            </div> 
	            
	            <form action="/gym/addLesson.do"  id="myform">
		            <input type="hidden" id="hid_add" name="l_g_id" th:value="${list[0].l_g_id}">
		            <input type="hidden" id="hid_add" name="l_weekday" th:value="${list[0].l_weekday}">
		            <input type="hidden" id="hid_add" name="l_datetime" th:value="${list[0].l_datetime}">
		            <div class="modal-body">
		            	
		            	<table border="1" cellspacing="0" cellpadding="0" style="width: 500px;">
							
							<tbody class="tbody">
								<tr align="center" >
									<!-- <td><img src="/html/gym/image/1.jpg"/></td>
									<td>李教练</td>
									<td>大宗师</td>
									<td>12343234234</td> -->
								</tr>
							</tbody>
						</table> 
		            	
		            	<br /><br />
		            	
		            	添加教练：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
			            <label class="label1"> 
			                <select class="coach_select" name="l_c_id">
			                	<option>暂无签约教练</option>
			                </select> 
			            </label>    
		                <input type="text" name="" id="input_name" placeholder="输入教练姓名或手机号"/>
		                <button type="button" onclick="findCoaByNameOrPho()">搜索教练</button><br /><br />
						课程价格(￥/节)：
						<input type="text" name="l_price" id="input_price" placeholder=""/>
						<span class="span error_price">*课程价格不能为空</span>
						<br /><br />               
						可容纳学员人数：
						<input type="text" name="l_size" id="input_number" placeholder=""/>
						<span class="span error_number">*可容纳学员人数不能为空</span>
						<br /><br />
						已有学员人数：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<input type="text" name="l_s_number" id="input_s_number" placeholder=""/>
						<br /><br />
						课程描述：&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
						<input type="text" name="l_descirbe" id="input_message" placeholder=""/>
						<span class="span error_message">*课程描述不能为空</span>
						<br /><br />
		            </div>  
		            <div class="modal-footer">  
		                <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>  
		                <button type="submit" class="btn btn-primary">确定</button>  
		            </div>  
		        </form>
	        </div> 
	        
	    </div>  
	</div>  
	
	
	
	
	<footer id="gtco-footer" role="contentinfo">
		<div class="gtco-container">
			<div class="row row-p	b-md">

				<div class="col-md-4">
					<div class="gtco-widget">
						<h3>关于我们</h3>
						<p>蜗牛46期第六组项目，由项目负责人温攀，会长文然，技术负责人黄仁杰，产品经理滕伟，后台管理刘勇，前端张正宇负责</p>
					</div>
				</div>

				<div class="col-md-2 col-md-push-1"></div>
				
				<div class="col-md-3 col-md-push-1">
					<div class="gtco-widget">
						<h3>联系方式</h3>
						<ul class="gtco-quick-contact">
							<li><a href="#"><i class="icon-phone"></i> 15002881866</a></li>
							<li><a href="#"><i class="icon-mail2"></i> shinoda@live.cn</a></li>
							<li><a href="#"><i class="icon-chat"></i> Zzy19951117</a></li>
						</ul>
					</div>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12">
					<p class="pull-left">
						<small class="block">&copy; 2019 在蜗牛46期写出来的.</small> 
						<small class="block">模板都是网上找的，描述都是自己瞎BB的</small>
					</p>
					<p class="pull-right">
						<ul class="gtco-social-icons pull-right">
							<li><a href="/html/gym/index.html">场馆展示</a></li>
							<li><a href="/gym/showMessage.do">场馆资料</a></li>
							<li><a href="/html/gym/lesson.html">课程安排</a></li>
							<li><a href="/html/gym/wallet.html">我的钱包</a></li>
							<li><a href="/html/gym/myCoach.html">我的签约教练</a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
		<!-- jQuery -->
	<script src="../../js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="../../js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="../../js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="../../js/jquery.waypoints.min.js"></script>
	<!-- Carousel -->
	<script src="../../js/owl.carousel.min.js"></script>
	<!-- countTo -->
	<script src="../../js/jquery.countTo.js"></script>

	<!-- Stellar Parallax -->
	<script src="../../js/jquery.stellar.min.js"></script>

	<!-- Magnific Popup -->
	<script src="../../js/jquery.magnific-popup.min.js"></script>
	<script src="../../js/magnific-popup-options.js"></script>
	
	<!-- Datepicker -->
	<script src="../../js/bootstrap-datepicker.min.js"></script>
	

	<!-- Main -->
	<script src="../../js/main.js"></script>
	
	<script th:inline="javascript">
		
		var l_g_id = /*[[${list[0].l_g_id}]]*/"";
		var l_weekday = /*[[${list[0].l_weekday}]]*/0;
		var l_datetime = /*[[${list[0].l_datetime}]]*/0;
		
		//显示我的签约教练
		function findMyCoach(){
			$.ajax({
				type:"get",
				async:true,
				url:"/gym/findMyCoach.do",
				/* data:"l_g_id="+l_g_id,  */
				success:function(mes){
					console.info(mes);
					var str ="";
					str+="<select class='coach_select' name='l_c_id'>"
					
					if(mes.length>0){
						for(var i=0;i<mes.length;i++){
							str+="<option value='"+mes[i].c_id+"'>"+mes[i].c_nickname+"</option>"
						}	
					}else{
						str+="<option>暂无签约教练</option>"
					} 
					
					str+="</select>" ;
					$(".label1").html(str);
				}
			});
		}
		findMyCoach()
		
		//通过昵称或者电话号码查找我的教练
		
		function findCoaByNameOrPho(){
			var nameOrPho = document.getElementById("input_name").value;
			$.ajax({
				type:"get",
				async:true,
				url:"/gym/findCoaByNameOrPho.do",
				data:"g_id="+l_g_id+"&nameOrPho="+nameOrPho, 
				success:function(mes){
					var str ="";
					str+="<tr align='center'>"+
						"<td>教练头像</td>"+
						"<td>教练姓名</td>"+
						"<td>教练流派</td>"+
						"<td>电话号码</td>"+
					"</tr>"
					
					if (mes.length>0 && mes!="") {
						
						str+="<tr align='center' class='coach active'>"+
							"<input type='hidden' id='hid_coach' value='"+mes[0].c_id+"'>"+
							"<td><img src='/html/gym/image/"+mes[0].c_headimg+"'/></td>"+
							"<td>"+mes[0].c_nickname+"</td>"+
							"<td>"+mes[0].c_style+"</td>"+
							"<td>"+mes[0].c_phone+"</td>"+
						"</tr>"
						for(var i=1;i<mes.length;i++){
							str+="<tr align='center' class='coach'>"+
								"<input type='hidden' id='hid_coach' value='"+mes[i].c_id+"'>"+
								"<td><img src='/html/gym/image/"+mes[i].c_headimg+"'/></td>"+
								"<td>"+mes[i].c_nickname+"</td>"+
								"<td>"+mes[i].c_style+"</td>"+
								"<td>"+mes[i].c_phone+"</td>"+
							"</tr>"
						}
					}else{
						str+="<tr align='center'>"+
							"<td colspan='4'>没有搜索到相关的教练信息</td>"+
						"</tr>"
					}
					
					$(".tbody").html(str);
					
					var oCoach = $(".active #hid_coach")
					if(oCoach!=null){
						var c_id = $(".active #hid_coach").val();
						
						var sel = document.getElementsByClassName("coach_select")[0].options
						for (var i=0;i<sel.length;i++) {
							var coachId = sel[i].value;
							if (c_id==coachId) {
								sel[i].selected = true
							}
						} 
						
						$(".coach").click(function(){
							$(this).addClass("active").siblings().removeClass("active");
							c_id = $(".active #hid_coach").val();
							for (var i=0;i<sel.length;i++) {
								var coachId = sel[i].value;
								if (c_id==coachId) {
									sel[i].selected = true
								}
							} 
						});  
					} 
					
					
				}
			});
		} 
		
		
		
		
		//删除课程
		$(".gradeX").eq(0).addClass("active")
		var l_id = $(".active #hid").val();
		//alert(l_id)
		$(".gradeX").click(function(){
			$(this).addClass("active").siblings().removeClass("active");
			l_id = $(".active #hid").val();
			//alert(l_id)
		}); 
		function delLesson(){
			$.ajax({
				type:"get",
				async:true,
				url:"/gym/deleteLesson.do",
				data:"l_id="+l_id, 
				success:function(mes){
					console.info(mes);
					window.location.href = "/gym/showLesson.do?l_weekday="+l_weekday+"&l_datetime="+l_datetime;
				}
			});
		}
		
	</script>	

	</body>
</html>

<script type="text/javascript">
    
    function showError(oinp,ospan) {
	    var inpValue = oinp.value;
	    //alert(inpValue);
	    if(inpValue=="" || inpValue==null || inpValue==0){
	        ospan.style.visibility = "visible";
	        return false;
	    }else {
	        ospan.style.visibility = "hidden";
	        return true;
	    }
	}
    
	var oinp_price = document.getElementById("input_price");
	var ospan_price = document.getElementsByClassName("error_price")[0];
	oinp_price.onblur = function(){
		return showError(oinp_price,ospan_price);
	}
	
	var oinp_number = document.getElementById("input_number");
	var ospan_number = document.getElementsByClassName("error_number")[0];
	oinp_number.onblur = function(){
		return showError(oinp_number,ospan_number);
	}
    
    var oinp_message = document.getElementById("input_message");
	var ospan_message = document.getElementsByClassName("error_message")[0];
	oinp_message.onblur = function(){
		return showError(oinp_message,ospan_message);
	}
	
	/*var oinp_phone = document.getElementById("input_phone");
	var ospan_phone = document.getElementsByClassName("error_phone")[0];
	oinp_phone.onblur = function(){
        var regexp = /^[0-9]{11}$/;
        var inpValue = this.value;
        if(!regexp.test(inpValue)){
        	ospan_phone.style.visibility = "visible";
            return false;
        }else{
        	ospan_phone.style.visibility = "hidden";
            return true;
        }
    }*/
    
	/*
     * 阻止表单提交
     * return false 阻止表单提交
     * */
    var oform = document.getElementById("myform")
    oform.onsubmit = function(){
        //onblur()表示执行一次 匿名函数
        var boo1 = oinp_price.onblur();
        var boo2 = oinp_number.onblur();
        var boo3 = oinp_message.onblur();
        if(boo1 && boo2 && boo3){
            return true;
        }
        return false;
    } 
</script>