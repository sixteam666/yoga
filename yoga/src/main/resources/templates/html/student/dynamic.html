<!DOCTYPE HTML>

<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>个人中心</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by FreeHTML5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="FreeHTML5.co" />

	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="../../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../../css/icomoon.css">
	<!-- Themify Icons-->
	<link rel="stylesheet" href="../../css/themify-icons.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../../css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/magnific-popup.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../../css/bootstrap-datepicker.min.css">

	<!-- Owl Carousel  -->
	<link rel="stylesheet" href="../../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../../css/owl.theme.default.min.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="../../css/style.css">

	<!-- Modernizr JS -->
	<script src="../../js/modernizr-2.6.2.min.js"></script>

	<style type="text/css">
		.fon{
			font-family: "微软雅黑";
		}
		
		.round_icon{
		  width: 60px;
		  height: 60px;
		  /* display: flex; */
		  border-radius: 50%;
		  align-items: center;
		  justify-content: center;
		  overflow: hidden;
		}
		
		/*九宫格显示图片*/
	    ul { list-style: none outside none; margin:0; padding: 0; }
	    body .mainmenu:after { clear: both; content: " "; display: block; }
	
	    body .mainmenu li{ 
	        float:left;
	        width: 30%;  
	        border-radius:3px; 
	        overflow:hidden;
	    }
	    
	    body .mainmenu li img{ 
	        margin: 0 9px 10px;
	        width: 100px;
	        height: 100px;
	    }

	</style>
	<style>
		.nineImg{
			margin-top: -4px;
			margin-left: 10px;
			z-index: 0;
		}
		.img_1{
			position: relative;
			float: left;
			width: 70px;
			height: 70px;
			z-index: 2;
		}
		.span1{
			color: black;
			position: absolute;
			top: -8px;
			left: 53px;
			z-index: 3;
		}
		
		.img_add{
			margin-top: -66px;
			z-index: -2;
		}
		.nineImg img{
			padding: 4px;
			float: left;
			width: 70px;
			height: 70px;
		}
	</style>
	<style>
		.img9{
			padding: 4px;
			float: left;
			width: 70px;
			height: 70px;
		}
		.preview{
			position: absolute;
			z-index: 2;
		}
		.preview img{
			/*margin-top: -70px;*/
			width: 70px;
			height: 70px;
			/*z-index: 3;*/
		}
		
		
		#file {
			position: relative;
			display: block;
			width: 62px;
			height: 62px;
			background: red;
			overflow: hidden;
			z-index: 1;
			left: 5px;
			opacity:0;/*透明度设置*/
		}
		#file input {
			position: absolute;
			font-size: 15pt;
			width: 62px;
			height: 62px;
			right: 0;
			top: 0;
			opacity: 0
			z-index: 1;
		}
	</style>
</head>
<body>

	<nav class="gtco-nav" role="navigation" th:fragment="common_head">
		<div class="gtco-container">
			
			<div class="row" style="background-color:#09C6AB ;">
				<div class="col-sm-4 col-xs-12">
					<ul>
						<li><a th:href="@{/student/stu.do}" class="fon">首页</a></li>
						<li><a th:href="@{/student/showGym.do}" class="fon">所有场馆</a></li>
						<li><a th:href="@{/student/showCoach.do}" class="fon">附近教练</a></li>
						<li><a href="/dynamic/showHot.do">动态</a></li>
					</ul>
				</div>
				<div class="col-xs-8 text-right menu-1">
					<ul>
						<li class="has-dropdown">
							<span th:text="|欢迎您: ${session.stu.s_name}|" style="color: white;">欢迎您，用户名</span>
							<a href="/student/logout.do">注销</a>
						</li>
						<li class="has-dropdown">
							<a href="#">个人中心</a>
							<ul class="dropdown">
								<li><a href="/student/mypage.do">个人主页</a></li>
								<li><a href="/student/showStudent.do">个人资料</a></li>
								<li><a href="/student/findcourse.do">课程中心</a></li>
								<li><a href="/student/findorder.do">我的订单</a></li>
								<li><a href="/student/notify.do">我的通知</a></li>
							</ul>
						</li>
					</ul>	
			</div>
			</div>
			
		</div>
	</nav>
	
	<div class="gtco-section border-bottom" th:fragement="common_dynamic">
		<div class="gtco-container">
			<div class="row" style="padding:0 0 50px">
				<div class="col-md-2 col-md-offset-1">
					<button onclick="publish()">发表新动态</button>
				</div>
			</div>
			<div id="publish" class="row" style="display:none;">
				<div class="col-md-9 col-md-offset-1" align="left" >
					<div class="row">
						<form action="/dynamic/addDynamic.do" method="post" enctype="multipart/form-data" onsubmit="return checkContent()">
							<div class="" style="width:500px;height:200px;float: left;" >
								<textarea id="dcontent" name="d_content" style="width:500px;height:200px;" placeholder="说点什么吧！（30字以内）"></textarea>
							</div> 
							<div class="nineImg" style="float: left;width:230px;height:200px;">
								
								<div class="img_1">
									<span class="span1" onclick="deleteImg(this)"></span>
									<a href="javascript:;" id="file">
										<span>选择文件</span>
										<input type="file" onchange="preview(this)" name="dynamicImg"/>
									</a>
									<div class="img_add">
										<img src="/image/dynamicImg/add.jpg" />
									</div>
									<div class="preview">
										<!--<img src="image/1.jpg" />-->
									</div>
								</div>
								<!--<div class="img9">
									<a href="javascript:;" id="file">
										<span>选择文件</span>
										<input type="file" onchange="preview(this)" style="background: blue ;"/>
									</a>
									<div class="preview">
										<img src="image/add.jpg" />
									</div>
								</div>-->
								<div class="img_null">
									
								</div>
							</div>
							<div class="col-md-1 col-md-offset-1" >
								<input type="submit" class="btn" value="发表" style="float:left;margin-top:30px;margin-left: -580px;" />
							</div>
							
							<div style="height:50px" class="col-md-12"></div>
						</form>
					</div>
				</div>
			</div>
			<div class="row">
				<div th:each="dynamic : ${dynamicList}" class="col-md-10 col-md-offset-1">
					<div class="row">
						<div class="col-md-1">
							<a th:href="|/student/hispage.do?id=${dynamic.d_userid}|">
								<img th:src="@{/image/headImg/}+${dynamic.d_headimg}" class="round_icon" >
							</a>
						</div>
						<div class="col-md-3">
							<a href="#">
								<span th:text="${dynamic.d_nickname}">猜猜我是谁</span>
							</a>
							<p th:text="${dynamic.d_time}">今天 13:20</p>
						</div>
						<div class="col-md-5" style="height:74px"></div>
						<div class="col-md-2">
							<button style="color:white;border:none" 
								th:if="${dynamic.follow == 1}">已关注</button>
							<button style="background-color:#2fddc3;color:white;border:none" 
							th:if="${dynamic.follow == 0}" th:value="${dynamic.d_userid}"
							th:onclick="|addFollow(this)|">&nbsp;+&nbsp;&nbsp;关注</button>
						</div>
						<div class="col-md-10">
							<p th:text="${dynamic.d_content}"></p>
						</div>
						<div class="col-md-5" th:if="${dynamic.pictures != null}">
							<ul class="mainmenu">
						        <li th:each="picture : ${dynamic.pictures}">
						        	<img th:src="|@{/image/dynamicImg/}${picture.dp_img}|" />
						        </li>
						    </ul>
					    </div>
					</div>
					<hr>
				</div>
			</div>
		</div>
	</div>
	
	<footer id="gtco-footer" role="contentinfo">
	
	
		<div class="gtco-container">
			<div class="row row-p b-md">
				<div class="col-md-4">
					<div class="gtco-widget">
						<h3>关于我们</h3>
						<p>蜗牛46期第六组项目，由项目负责人温攀，会长文然，技术负责人黄仁杰，产品经理滕伟，后台管理刘勇，前端张正宇负责</p>
					</div>
				</div>

				<div class="col-md-2 col-md-push-1"></div>
				
				<div class="col-md-2 col-md-push-1">
					<div class="gtco-widget">
						<h3 class="fon">瑜伽平台</h3>
						<ul class="gtco-footer-links">
							<li><a href="coachLogin.html" class="fon">成为教练</a></li>
							<li><a href="gymLogin.html" class="fon">场馆入驻</a></li>
						</ul>
					</div>
				</div>

				<div class="col-md-3 col-md-push-1">
					<div class="gtco-widget">
						<h3>联系方式</h3>
						<ul class="gtco-quick-contact">
							<li><a href="#"><i class="icon-phone"></i> 15002881866</a></li>
							<li><a href="#"><i class="icon-mail2"></i> shinoda@live.cn</a></li>
							<li><a href="#"><i class="icon-chat"></i> Zzy19951117</a></li>
						</ul>
					</div>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12">
					<p class="pull-left">
						<small class="block">&copy; 2019 在蜗牛46期写出来的.</small> 
						<small class="block">模板都是网上找的，描述都是自己瞎BB的</small>
					</p>
					<p class="pull-right">
						<ul class="gtco-social-icons pull-right">
							<li><a href="#"><i class="icon-twitter"></i></a></li>
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
		<!-- jQuery -->
	<script src="../../js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="../../js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="../../js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="../../js/jquery.waypoints.min.js"></script>
	<!-- Carousel -->
	<script src="../../js/owl.carousel.min.js"></script>
	<!-- countTo -->
	<script src="../../js/jquery.countTo.js"></script>

	<!-- Stellar Parallax -->
	<script src="../../js/jquery.stellar.min.js"></script>

	<!-- Magnific Popup -->
	<script src="../../js/jquery.magnific-popup.min.js"></script>
	<script src="../../js/magnific-popup-options.js"></script>
	
	<!-- Datepicker -->
	<script src="../../js/bootstrap-datepicker.min.js"></script>
	

	<!-- Main -->
	<script src="../../js/main.js"></script>
	<script>
		function publish() {
			$("#publish").slideToggle("slow");
		}
	</script>
	
	<script type="text/javascript" th:inline="javascript">
	
	//关注 
	//添加关注
		function addFollow(obj) {
			var followId = $(obj).attr("value");
			$.ajax({
				url: "/dynamic/addFollow.do",
				type: "post",
				data: "followId="+followId,
				success: function() {
					$(obj).html("已关注");
					$(obj).css("backgroundColor","");
					$(obj).removeAttr("onclick");
				}
			});
		}

	</script>
	<script>
		function preview(file) { //预览图片得到图片base64
			//var prevDiv = document.getElementsByClassName('img9')[0];
			if(file.files && file.files[0]) {
				var reader = new FileReader();
				reader.onload = function(evt) {
					var str1 = '';
					var str2 = 'x';
					var str3 = '';
					str1+='<div class="img_1">'+
						'<span class="span1" onclick="deleteImg(this)"></span>'+
						'<a href="javascript:;" id="file">'+
							'<span>选择文件</span>'+
							'<input type="file" onchange="preview(this)" name="dynamicImg"/>'+
						'</a>'+
						'<div class="img_add">'+
							'<img src="/image/dynamicImg/add.jpg" />'+
						'</div>'+
						'<div class="preview">'+
						'</div>'+
					'</div>';
					str3 +='<img src="' + evt.target.result + '"/>'
					
					
					if ($(".img_1").length<9) {
						$(".img_null").before(str1);
						$(file).parent().prev().html(str2);
						$(file).parent().next().next().html(str3);
					}else if($(".img_1").length==9){
						$(file).parent().prev().html(str2);
						$(file).parent().next().next().html(str3);
					}
				}
				reader.readAsDataURL(file.files[0]);
			} 
		}
		function deleteImg(obj){
			var str = '';
			str+='<div class="img_1">'+
				'<span class="span1" onclick="deleteImg(this)"></span>'+
				'<a href="javascript:;" id="file">'+
					'<span>选择文件</span>'+
					'<input type="file" onchange="preview(this)" name="dynamicImg"/>'+
				'</a>'+
				'<div class="img_add">'+
					'<img src="/image/dynamicImg/add.jpg" />'+
				'</div>'+
				'<div class="preview">'+
				'</div>'+
			'</div>';
			$(obj).parent().remove();
			if ($(".img_1").length==8 ) {
				if($(".img_1").eq(7).find("span").html()=="x"){
					$(".img_null").before(str);
				}
				
			}
		}
		//无内容时无法发表
		function checkContent() {
			var dcontent = $("#dcontent").html();
			alert(dcontent)
			if(dcontent == null || dcontent == "") {
				alert(dcontent)
				return false;
			}
		}
	</script>
	</body>
</html>

